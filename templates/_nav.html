<div class="border-end bg-white" id="sidebar-wrapper">
  <div class="sidebar-heading d-flex justify-content-between align-items-center px-3 py-8 mt-2">
    Sumarização Gist
    <a href="#" onclick="carregarFormulario()" title="Adicionar URL e arquivo">
      <i class="bi bi-pencil-square" style="font-size: 1.2rem; color: #000;"></i>
    </a>
  </div>

  <div class="list-group list-group-flush m-1">
    {% for secao in secoes %}
    <div class="d-flex align-items-center justify-content-between list-group-item py-3 px-4 rounded border-0 position-relative"
         style="background-color: #f8f9fa; transition: background-color 0.2s; margin-bottom: 0.5rem;">
      
      <a href="#" class="text-decoration-none text-dark flex-grow-1 link-secao word-wrap: break-word;" data-pk="{{ secao.id }}">
        {{ secao.nome }}
      </a>

      <button class="btn btn-light ms-0 toggle-menu" style="padding: 0.25rem;">
        <i class="bi bi-three-dots" style="font-size: 0.9rem;"></i>
      </button>

      <div class="menu-opcoes position-absolute end-0 mt-5 p-2 bg-white shadow rounded d-none" style="z-index: 1000;">
        <a href="del/{{ secao.id }}/" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></a>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<script>
document.addEventListener("click", function (e) {
  const isMenuButton = e.target.closest(".toggle-menu");
  const isInsideMenu = e.target.closest(".menu-opcoes");

  if (isMenuButton) {
    document.querySelectorAll(".menu-opcoes").forEach(menu => {
      menu.classList.add("d-none");
    });

    const container = isMenuButton.closest(".list-group-item");
    const menu = container.querySelector(".menu-opcoes");
    menu.classList.toggle("d-none");

    e.stopPropagation(); 
    return;
  }

  if (!isInsideMenu) {
    document.querySelectorAll(".menu-opcoes").forEach(menu => {
      menu.classList.add("d-none");
    });
  }
});
</script>